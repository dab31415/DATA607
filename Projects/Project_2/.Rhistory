ggplot(aes(x = month_name, y = weather_value, group = weather_attr), group = 1) + geom_line()
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
#ggplot(aes(x = month_name, y = weather_value, color = weather_attr), group = 1) + geom_line()
ggplot(aes(x = month_name, y = weather_value, color = weather_attr), group = 1) + geom_line()
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
#ggplot(aes(x = month_name, y = weather_value, color = weather_attr), group = 1) + geom_line()
ggplot(aes(x = month_name, y = weather_value, color = weather_attr)) + geom_line()
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, color = weather_attr), group = 1) + geom_point()
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
#ggplot(aes(x = month_name, y = weather_value, color = weather_attr), group = 1) + geom_point()
ggplot(aes(x = month_name, y = weather_value, group = weather_attr)) + geom_point()
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
#ggplot(aes(x = month_name, y = weather_value, color = weather_attr), group = 1) + geom_point()
ggplot(aes(x = month_name, y = weather_value, group = weather_attr)) + geom_line()
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
#ggplot(aes(x = month_name, y = weather_value, color = weather_attr), group = 1) + geom_point()
ggplot(aes(x = month_name, y = weather_value, color = weather_attr)) + geom_line()
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
#ggplot(aes(x = month_name, y = weather_value, color = weather_attr), group = 1) + geom_point()
ggplot(aes(x = month_name, y = weather_value, group = weather_attr)) + geom_line()
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
#ggplot(aes(x = month_name, y = weather_value, color = weather_attr), group = 1) + geom_point()
ggplot(aes(x = month_name, y = weather_value, group = weather_attr)) + geom_point()
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
#ggplot(aes(x = month_name, y = weather_value, color = weather_attr), group = 1) + geom_point()
ggplot(aes(x = month_name, y = weather_value, color = weather_attr)) + geom_point()
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, color = weather_attr)) + geom_point() +
title('Average Temperatures in Aruba')
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, color = weather_attr)) + geom_point() +
title('Average Temperatures in Aruba')
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, color = weather_attr)) + geom_line(group = weather_attr)
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, color = weather_attr)) + geom_point()
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, color = weather_attr)) +
geom_point() +
ggtitle('Average Temperatures in Aruba') +
xlab('Month') + ylab('Temperature (F)')
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, color = weather_attr)) +
geom_point() +
ggtitle('Average Temperatures in Aruba') +
xlab('Month') + ylab('Temperature (°F)')
cc_file = 'https://raw.githubusercontent.com/dab31415/DATA607/main/Projects/Project_2/CustomerChurn.csv'
cc_raw <-read_csv(cc_file,show_col_types = FALSE)
cc_raw
cc_file = 'https://raw.githubusercontent.com/dab31415/DATA607/main/Projects/Project_2/CustomerChurn.csv'
cc_raw <-read_csv(cc_file,show_col_types = FALSE, fill = TRUE)
cc_file = 'https://raw.githubusercontent.com/dab31415/DATA607/main/Projects/Project_2/CustomerChurn.csv'
cc_raw <-read_csv(cc_file,show_col_types = FALSE)
cc_raw
cc_file = 'https://raw.githubusercontent.com/dab31415/DATA607/main/Projects/Project_2/CustomerChurn.csv'
cc_raw <-read_csv(cc_file,show_col_types = FALSE)
cc_raw
cc_tidy <- cc_raw %>%
fill(Division, direction = 'down')
cc_tidy <- cc_raw %>%
fill(Division, direction = c('down'))
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down')
pivot_longer(-weather_attr, names_to = 'month_name', values_to = 'weather_value') %>%
pivot_wider(names_from = weather_attr, values_from = weather_value)
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down')
View(cc_tidy)
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down') %>%
pivot_longer(-c('Division','Description'),names_to = 'month_name', values_to = 'churn_values')
View(cc_tidy)
View(cc_tidy)
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down') %>%
pivot_longer(-c('Division','Description'),names_to = 'month_name', values_to = 'customers')
# Specify month as an ordered factor for plotting
cc_tidy$month_name <- factor(cc_tidy$month_name, levels = month.abb)
cc_tidy
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down') %>%
filter(grepl('^[A-Z]$',Division) %>%
pivot_longer(-c('Division','Description'),names_to = 'month_name', values_to = 'customers')
# Specify month as an ordered factor for plotting
cc_tidy$month_name <- factor(cc_tidy$month_name, levels = month.abb)
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down') %>%
filter(grepl('^[A-Z]$',Division)) %>%
pivot_longer(-c('Division','Description'),names_to = 'month_name', values_to = 'customers')
# Specify month as an ordered factor for plotting
cc_tidy$month_name <- factor(cc_tidy$month_name, levels = month.abb)
cc_tidy
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down') %>%
filter(grepl('^[A-Z]$',Division)) %>%
pivot_longer(-c('Division','Description'),names_to = 'month_name', values_to = 'customers') %>%
pivot_wider(names_from = Description, values_from = 'customers')
# Specify month as an ordered factor for plotting
cc_tidy$month_name <- factor(cc_tidy$month_name, levels = month.abb)
cc_tidy
cumsum(1:10)
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down') %>%
filter(grepl('^[A-Z]$',Division)) %>%
pivot_longer(-c('Division','Description'),names_to = 'month_name', values_to = 'customers') %>%
pivot_wider(names_from = Description, values_from = 'customers') %>%
mutate(Net = Gained + Lost)
# Specify month as an ordered factor for plotting
cc_tidy$month_name <- factor(cc_tidy$month_name, levels = month.abb)
cc_tidy
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down') %>%
filter(grepl('^[A-Z]$',Division)) %>%
pivot_longer(-c('Division','Description'),names_to = 'month_name', values_to = 'customers') %>%
pivot_wider(names_from = Description, values_from = 'customers') %>%
mutate(Net = Gained + Lost) %>%
mutate(Total = cumsum(Net))
# Specify month as an ordered factor for plotting
cc_tidy$month_name <- factor(cc_tidy$month_name, levels = month.abb)
cc_tidy
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down') %>%
filter(grepl('^[A-Z]$',Division)) %>%
pivot_longer(-c('Division','Description'),names_to = 'month_name', values_to = 'customers') %>%
pivot_wider(names_from = Description, values_from = 'customers') %>%
mutate(Net = Gained + Lost)
# Specify month as an ordered factor for plotting
cc_tidy$month_name <- factor(cc_tidy$month_name, levels = month.abb)
cc_tidy
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down') %>%
filter(grepl('^[A-Z]$',Division)) %>%
pivot_longer(-c('Division','Description'),names_to = 'month_name', values_to = 'customers') %>%
pivot_wider(names_from = Description, values_from = 'customers') %>%
mutate(Net = Gained + Lost)
(cc_tidy %>% group_by(Division) %>% mutate(Total = cumsum(Net)))
# Specify month as an ordered factor for plotting
cc_tidy$month_name <- factor(cc_tidy$month_name, levels = month.abb)
cc_tidy
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down') %>%
filter(grepl('^[A-Z]$',Division)) %>%
pivot_longer(-c('Division','Description'),names_to = 'month_name', values_to = 'customers') %>%
pivot_wider(names_from = Description, values_from = 'customers') %>%
mutate(Net = Gained + Lost)
# Specify month as an ordered factor for plotting
cc_tidy$month_name <- factor(cc_tidy$month_name, levels = month.abb)
cc_tidy
cc_tidy %>% group_by(Division) %>% select(month_name, Division, Total = cumsum(Net))
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down') %>%
filter(grepl('^[A-Z]$',Division)) %>%
pivot_longer(-c('Division','Description'),names_to = 'month_name', values_to = 'customers') %>%
pivot_wider(names_from = Description, values_from = 'customers') %>%
mutate(Net = Gained + Lost)
# Specify month as an ordered factor for plotting
cc_tidy$month_name <- factor(cc_tidy$month_name, levels = month.abb)
cc_tidy
cc_tidy %>% group_by(Division) %>% select(month_name, Division, Total = cumsum(Net))
cc_tidy %>% group_by(Division) %>% mutate(Total = cumsum(Net))
cc_tidy <- cc_tidy %>% group_by(Division) %>% mutate(Total = cumsum(Net))
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down') %>%
filter(grepl('^[A-Z]$',Division)) %>%
pivot_longer(-c('Division','Description'),names_to = 'month_name', values_to = 'customers') %>%
pivot_wider(names_from = Description, values_from = 'customers') %>%
mutate(Net = Gained + Lost) %>%
group_by(Division) %>%
mutate(Total = cumsum(Net))
# Specify month as an ordered factor for plotting
cc_tidy$month_name <- factor(cc_tidy$month_name, levels = month.abb)
cc_tidy
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down') %>%
filter(grepl('^[A-Z]$',Division)) %>%
pivot_longer(-c('Division','Description'),names_to = 'month_name', values_to = 'customers') %>%
pivot_wider(names_from = Description, values_from = 'customers') %>%
mutate(Net = Gained + Lost) %>%
group_by(Division) %>%
mutate(Total = cumsum(Net),
Churn = (-1 * Lost) / (Total - Net))
# Specify month as an ordered factor for plotting
cc_tidy$month_name <- factor(cc_tidy$month_name, levels = month.abb)
cc_tidy
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down') %>%
pivot_longer(-c('Division','Description'),names_to = 'month_name', values_to = 'customers') %>%
pivot_wider(names_from = Description, values_from = 'customers') %>%
mutate(Net = Gained + Lost) %>%
group_by(Division) %>%
mutate(Total = cumsum(Net),
Churn = (-1 * Lost) / (Total - Net))
# Specify month as an ordered factor for plotting
cc_tidy$month_name <- factor(cc_tidy$month_name, levels = month.abb)
cc_tidy
ggplot(cc_tidy,aes(x = month_name, y = Churn, color = Division)) +
geom_point()
ggplot(cc_tidy,aes(x = month_name, y = Churn, color = Division)) +
geom_point() + geom_line()
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, group = weather_attr)) +
geom_line(aes(linetype = weather_attr, color = weather_attr)) +
geom_point(aes(color = weather_attr))
#ggtitle('Average Temperatures in Aruba') +
#xlab('Month') + ylab('Temperature (°F)')
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, group = weather_attr)) +
geom_line(aes(linetype = solid, color = weather_attr)) +
geom_point(aes(color = weather_attr))
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, group = weather_attr)) +
geom_line(aes(linetype = 'solid', color = weather_attr)) +
geom_point(aes(color = weather_attr))
#ggtitle('Average Temperatures in Aruba') +
#xlab('Month') + ylab('Temperature (°F)')
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, group = weather_attr)) +
geom_line(aes(linetype = weather_attr, color = weather_attr)) +
geom_point(aes(color = weather_attr))
#ggtitle('Average Temperatures in Aruba') +
#xlab('Month') + ylab('Temperature (°F)')
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, group = weather_attr)) +
geom_line(aes(linetype = weather_attr, color = weather_attr)) +
geom_point(aes(color = weather_attr)) +
ggtitle('Average Temperatures in Aruba') +
xlab('Month') + ylab('Temperature (°F)') +
scale_color_manual(labels = c('Avg High','Avg Low'), values = c('darkred','darkblue'))
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, group = weather_attr)) +
geom_line(aes(color = weather_attr)) +
#geom_point(aes(color = weather_attr)) +
ggtitle('Average Temperatures in Aruba') +
xlab('Month') + ylab('Temperature (°F)') +
scale_color_manual(labels = c('Avg High','Avg Low'), values = c('darkred','darkblue'))
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, group = weather_attr)) +
geom_line(aes(color = weather_attr)) +
geom_point(aes(color = weather_attr)) +
ggtitle('Average Temperatures in Aruba') +
xlab('Month') + ylab('Temperature (°F)') +
scale_color_manual(labels = c('Avg High','Avg Low'), values = c('darkred','darkblue'))
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, group = weather_attr)) +
geom_line(aes(color = weather_attr)) +
geom_point(aes(color = weather_attr, size = 2)) +
ggtitle('Average Temperatures in Aruba') +
xlab('Month') + ylab('Temperature (°F)') +
scale_color_manual(labels = c('Avg High','Avg Low'), values = c('darkred','darkblue'))
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, group = weather_attr)) +
geom_line(aes(color = weather_attr)) +
geom_point(aes(color = weather_attr, size = 1)) +
ggtitle('Average Temperatures in Aruba') +
xlab('Month') + ylab('Temperature (°F)') +
scale_color_manual(labels = c('Avg High','Avg Low'), values = c('darkred','darkblue'))
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, group = weather_attr)) +
geom_line(aes(color = weather_attr)) +
geom_point(aes(color = weather_attr), size = 1) +
ggtitle('Average Temperatures in Aruba') +
xlab('Month') + ylab('Temperature (°F)') +
scale_color_manual(labels = c('Avg High','Avg Low'), values = c('darkred','darkblue'))
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, group = weather_attr)) +
geom_line(aes(color = weather_attr)) +
geom_point(aes(color = weather_attr), size = 2) +
ggtitle('Average Temperatures in Aruba') +
xlab('Month') + ylab('Temperature (°F)') +
scale_color_manual(labels = c('Avg High','Avg Low'), values = c('darkred','darkblue'))
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, group = weather_attr)) +
geom_line(aes(color = weather_attr)) +
geom_point(aes(color = weather_attr), size = 2) +
ggtitle('Average Temperatures in Aruba') +
xlab('Month') + ylab('Temperature (°F)') +
scale_color_manual(labels = c('Avg High','Avg Low'), values = c('darkred','darkblue')) +
guides(fill=guide_legend(title = 'Temp'))
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, group = weather_attr)) +
geom_line(aes(color = weather_attr)) +
geom_point(aes(color = weather_attr), size = 2) +
ggtitle('Average Temperatures in Aruba') +
xlab('Month') + ylab('Temperature (°F)') +
scale_color_manual(labels = c('Avg High','Avg Low'), values = c('darkred','darkblue')) +
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, group = weather_attr)) +
geom_line(aes(color = weather_attr)) +
geom_point(aes(color = weather_attr), size = 2) +
ggtitle('Average Temperatures in Aruba') +
xlab('Month') + ylab('Temperature (°F)') +
scale_color_manual(labels = c('Avg High','Avg Low'), values = c('darkred','darkblue'))
aw_tidy %>%
pivot_longer(-month_name, names_to = 'weather_attr', values_to = 'weather_value') %>%
filter(weather_attr %in% c('high_temp','low_temp')) %>%
ggplot(aes(x = month_name, y = weather_value, group = weather_attr)) +
geom_line(aes(color = weather_attr)) +
geom_point(aes(color = weather_attr), size = 2) +
ggtitle('Average Temperatures in Aruba') +
xlab('Month') + ylab('Temperature (°F)') +
scale_color_manual(labels = c('Avg High','Avg Low'), values = c('darkred','darkblue'))
cc_tidy %>%
ggplot(aes(x = month_name, y = Churn, group = Division)) +
geom_line(aes(color = Division)) +
geom_point(aes(color = Division), size = 2) #+
#ggtitle('Average Temperatures in Aruba') +
#xlab('Month') + ylab('Temperature (°F)') +
#scale_color_manual(labels = c('Avg High','Avg Low'), values = c('darkred','darkblue'))
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down') %>%
pivot_longer(-c('Division','Description'),names_to = 'month_name', values_to = 'customers') %>%
pivot_wider(names_from = Description, values_from = 'customers') %>%
mutate(Net = Gained + Lost) %>%
group_by(Division) %>%
mutate(Total = cumsum(Net),
Churn = 100 * (-1 * Lost) / (Total - Net))
# Specify month as an ordered factor for plotting
cc_tidy$month_name <- factor(cc_tidy$month_name, levels = month.abb)
cc_tidy
cc_tidy %>%
ggplot(aes(x = month_name, y = Churn, group = Division)) +
geom_line(aes(color = Division)) +
geom_point(aes(color = Division), size = 2) +
ggtitle('Monthy Churn Rates by Division') +
xlab('Month') + ylab('Churn Rate')
st_file = 'https://raw.githubusercontent.com/dab31415/DATA607/main/Projects/Project_2/StudentTesting.csv'
st_raw <-read_csv(st_file,show_col_types = FALSE)
st_raw
?pivot_longer
st_tidy <- st_raw %>%
pivot_longer(c(2:9), names_to = c('Score','StudyTime'), names_pattern = 'Test(.)$')
st_tidy <- st_raw %>%
pivot_longer(c(2:9), names_to = c('Score','StudyTime'), names_pattern = '([^0-9]+Test)([1-9])')
View(st_tidy)
View(st_tidy)
st_tidy <- st_raw %>%
pivot_longer(-c(Student,Gender))
cc_tidy %>%
filter(!is.nan(Churn)) %>%
ggplot(aes(x = month_name, y = Churn, group = Division)) +
geom_line(aes(color = Division)) +
geom_point(aes(color = Division), size = 2) +
ggtitle('Monthy Churn Rates by Division') +
xlab('Month') + ylab('Churn Rate (%)')
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down') %>%
pivot_longer(-c('Division','Description'),names_to = 'month_name', values_to = 'customers') %>%
pivot_wider(names_from = Description, values_from = 'customers') %>%
mutate(Net = Gained + Lost) %>%
group_by(Division) %>%
mutate(Total = cumsum(Net),
#Churn = if (Total - Net == 0) {NA} else {100 * (-1 * Lost) / (Total - Net))}
if (Total - Net == 0){Churn = NA} else {Churn = 100 * (-1 * Lost) / (Total - Net)})
# Specify month as an ordered factor for plotting
cc_tidy$month_name <- factor(cc_tidy$month_name, levels = month.abb)
cc_tidy
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down') %>%
pivot_longer(-c('Division','Description'),names_to = 'month_name', values_to = 'customers') %>%
pivot_wider(names_from = Description, values_from = 'customers') %>%
mutate(Net = Gained + Lost) %>%
group_by(Division) %>%
mutate(Total = cumsum(Net),
Churn = if (Total - Net == 0) {NA} else {100 * (-1 * Lost) / (Total - Net)})
# Specify month as an ordered factor for plotting
cc_tidy$month_name <- factor(cc_tidy$month_name, levels = month.abb)
cc_tidy
cc_tidy <- cc_raw %>%
fill(Division, .direction = 'down') %>%
pivot_longer(-c('Division','Description'),names_to = 'month_name', values_to = 'customers') %>%
pivot_wider(names_from = Description, values_from = 'customers') %>%
mutate(Net = Gained + Lost) %>%
group_by(Division) %>%
mutate(Total = cumsum(Net),
Churn = 100 * (-1 * Lost) / (Total - Net))
# Specify month as an ordered factor for plotting
cc_tidy$month_name <- factor(cc_tidy$month_name, levels = month.abb)
cc_tidy
st_file = 'https://raw.githubusercontent.com/dab31415/DATA607/main/Projects/Project_2/StudentTesting.csv'
st_raw <-read_csv(st_file,show_col_types = FALSE)
names(2) <- 'ScoreTest1'
st_file = 'https://raw.githubusercontent.com/dab31415/DATA607/main/Projects/Project_2/StudentTesting.csv'
st_raw <-read_csv(st_file,show_col_types = FALSE)
names(st_raw)[2] <- 'ScoreTest1'
names(st_raw)[4] <- 'ScoreTest2'
names(st_raw)[6] <- 'ScoreTest3'
names(st_raw)[8] <- 'ScoreTest4'
st_raw
st_tidy <- st_raw %>%
pivot_longer(-c(Student,Gender),names_to = c('.value','TestNum'), names_pattern = c('(Score|TimeStudied)Test([1-9])))
st_tidy <- st_raw %>%
pivot_longer(-c(Student,Gender),names_to = c('.value','TestNum'), names_pattern = '(Score|TimeStudied)Test([1-9])')
st_tidy <- st_raw %>%
pivot_longer(-c(Student,Gender),names_to = c('.value','TestNum'), names_pattern = '(Score|TimeStudied)Test([1-9])')
st_tidy
st_tidy %>% ggplot(aes(x = TimeStudied, y = Score, shape = Gender, color = Gender)) +
geom_point()
st_tidy %>% ggplot(aes(x = TimeStudied, y = Score, shape = Gender, color = Gender)) +
geom_point()
st_tidy %>% ggplot(aes(x = TimeStudied, y = Score, shape = Gender, color = Gender)) +
geom_point() +
ggtitle('Time Studied vs Test Scores') +
xlab('Time Studied (minutes)') + ylab('Test Scores (%)')
st_tidy %>% ggplot(aes(x = TimeStudied, y = Score, shape = Gender, color = Gender)) +
geom_point() +
geom_smooth() +
ggtitle('Time Studied vs Test Scores') +
xlab('Time Studied (minutes)') + ylab('Test Scores (%)')
st_tidy %>% ggplot(aes(x = TimeStudied, y = Score, shape = Gender, color = Gender)) +
geom_point() +
ggtitle('Time Studied vs Test Scores') +
xlab('Time Studied (minutes)') + ylab('Test Scores (%)')
st_tidy %>% ggplot(aes(x = TimeStudied, y = Score, shape = Gender, color = Gender)) +
geom_point() +
geom_smooth(method = lm) +
ggtitle('Time Studied vs Test Scores') +
xlab('Time Studied (minutes)') + ylab('Test Scores (%)')
?geom_smooth
st_tidy %>% ggplot(aes(x = TimeStudied, y = Score, shape = Gender, color = Gender)) +
geom_point() +
geom_smooth(method = loess, formula = 'y ~ log(x)') +
ggtitle('Time Studied vs Test Scores') +
xlab('Time Studied (minutes)') + ylab('Test Scores (%)')
st_tidy %>% ggplot(aes(x = TimeStudied, y = Score, shape = Gender, color = Gender)) +
geom_point() +
geom_smooth() +
ggtitle('Time Studied vs Test Scores') +
xlab('Time Studied (minutes)') + ylab('Test Scores (%)')
st_tidy %>% ggplot(aes(x = TimeStudied, y = Score, shape = Gender, color = Gender)) +
geom_point() +
geom_smooth() +
ggtitle('Time Studied vs Test Scores') +
xlab('Time Studied (minutes)') + ylab('Test Scores (%)')
st_tidy %>% ggplot(aes(x = TimeStudied, y = Score, shape = Gender, color = Gender)) +
geom_point() +
geom_smooth(method = 'loess', formula = 'y ~ x') +
ggtitle('Time Studied vs Test Scores') +
xlab('Time Studied (minutes)') + ylab('Test Scores (%)')
st_tidy %>% ggplot(aes(x = TimeStudied, y = Score, shape = Gender, color = Gender)) +
geom_point() +
geom_smooth(method = 'loess', formula = 'y ~ sqrt(x)') +
ggtitle('Time Studied vs Test Scores') +
xlab('Time Studied (minutes)') + ylab('Test Scores (%)')
st_tidy %>% ggplot(aes(x = TimeStudied, y = Score, shape = Gender, color = Gender)) +
geom_point() +
geom_smooth(method = 'loess', formula = 'y ~ x') +
ggtitle('Time Studied vs Test Scores') +
xlab('Time Studied (minutes)') + ylab('Test Scores (%)')
st_tidy %>% ggplot(aes(x = TimeStudied, y = Score, shape = Gender, color = Gender)) +
geom_point() +
geom_smooth() +
ggtitle('Time Studied vs Test Scores') +
xlab('Time Studied (minutes)') + ylab('Test Scores (%)')
